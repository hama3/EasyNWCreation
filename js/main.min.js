$(function(){if("undefined"==typeof a)var a={};a.pcNode=0,a.ruNode=0,a.swNode=0,a.svNode=0,a.lanNode=0,a.mainDropFlg=!0,a.dropNodeInt=0,a.dropNodeName="",a.dropContextName="",a.points=[],a.lanArrClass=[],a.lanArrWidth=[],a.lanWidth=2,a.lanFlag,a.lanFlaglink,a.lanFlagPoint,a.lanFlagDelet,a.lanFlagMove,a.elLanMoveThis,a.addCtx,a.addCanvas,a.canvasWidth=$("#nsf-main").width(),a.canvasHeight=$("#nsf-main").height(),a.mainCanvasWidth=$("#nsf-main-canvas")[0].getBoundingClientRect().left-35,a.mainCanvasHeight=$("#nsf-main-canvas")[0].getBoundingClientRect().top-35,a.mainCtx=$("#nsf-main-canvas")[0].getContext("2d"),a.mainCtx.strokeStyle="#2fb9fe",a.bGlayFladg=!1,a.conitems={sm:{name:"SM",className:"context-SM",type:"text",value:"24"},ip:{name:"IPアドレス",className:"context-IP",type:"text"},sep1:"---------",del:{name:"削除"},qui:{name:"閉じる"}},a.conitems_2={sm_1:{name:"SM",className:"context-SM",type:"text",value:"24"},ip_1:{name:"IPアドレス",className:"context-IP",type:"text"},sm_2:{className:"context-SM",type:"text",value:"24"},ip_2:{className:"context-IP",type:"text"},sep1:"---------",del:{name:"削除"},qui:{name:"閉じる"}},a.conev={show:function(a){$.contextMenu.setInputValues(a,this.data())},hide:function(a){$.contextMenu.getInputValues(a,this.data()),$("#nsf-right dt:contains('"+a.$trigger[0].alt+"') + dd p span:first").text(this.data().ip),$("#nsf-right dt:contains('"+a.$trigger[0].alt+"') + dd p span:last").text(this.data().sm)}},a.conev_2={show:function(a){$.contextMenu.setInputValues(a,this.data())},hide:function(a){$.contextMenu.getInputValues(a,this.data()),$("#nsf-right dt:contains('"+a.$trigger[0].alt+"') + dd p:nth-of-type(1) span:first").text(this.data().ip_1),$("#nsf-right dt:contains('"+a.$trigger[0].alt+"') + dd p:nth-of-type(1) span:last").text(this.data().sm_1),$("#nsf-right dt:contains('"+a.$trigger[0].alt+"') + dd p:nth-of-type(2) span:first").text(this.data().ip_2),$("#nsf-right dt:contains('"+a.$trigger[0].alt+"') + dd p:nth-of-type(2) span:last").text(this.data().sm_2)}},a.fnAllReset=function(){a.pcNode=0,a.swNode=0,a.svNode=0,a.ruNode=0,a.lanNode=0,$("#nsf-right dl").html(""),$("#nsf-console").html(""),$("#nsf-main .ui-draggable").hasClass("lanLink")&&($("#nsf-main").off("mousedown",a.fnLanMoveDown),$("#nsf-main").off("mouseup",a.fnLanMoveUp),$("html").off("mouseup",a.fnLanMoveOutUp)),$("#nsf-main img").remove(),$("#nsf-main-canvas").removeClass(),a.mainCtx.clearRect(0,0,a.canvasWidth,a.canvasHeight)},a.fnPacketChenge=function(a,n,t){$("#"+a+"-packet").attr("src")==="img/"+a+"_1.png"?($("#"+a+"-packet").attr("src","img/"+a+"_2.png"),$("#"+n+"-packet").attr("src")==="img/"+n+"_2.png"?$("#"+n+"-packet").attr("src","img/"+n+"_1.png"):$("#"+t+"-packet").attr("src")==="img/"+t+"_2.png"&&$("#"+t+"-packet").attr("src","img/"+t+"_1.png")):$("#"+a+"-packet").attr("src","img/"+a+"_1.png")},a.fnPacketAdd=function(){var n=$(this);"img/get_2.png"===$("#get-packet").attr("src")?n.hasClass("get-node")||(n.hasClass("send-node")?(n.removeClass("send-node"),n.prev().remove(),a.fnSetBadge(this,"get-node")):a.fnSetBadge(this,"get-node")):"img/send_2.png"===$("#send-packet").attr("src")?n.hasClass("get-node")?($(".send-node").prev().remove(),$("#nsf-main img").removeClass("send-node"),n.removeClass("get-node"),n.prev().remove(),a.fnSetBadge(this,"send-node")):n.hasClass("send-node")||($(".send-node").prev().remove(),$("#nsf-main img").removeClass("send-node"),a.fnSetBadge(this,"send-node")):"img/reset_2.png"===$("#reset-packet").attr("src")&&(n.hasClass("get-node")||n.hasClass("send-node"))&&(n.prev().remove(),n.removeClass("get-node"),n.removeClass("send-node"))},a.fnSetBadge=function(a,n){$(a).addClass(n),$(a).before("<img src='img/badge_"+n+".png' class='"+n+"2'>"),$(a).prev().offset({top:a.offsetTop-15,left:a.offsetLeft+42})},a.fnGlayInfoLeft=function(){$("#slideUl:not(:animated)").css("margin-left",-1*$("#slideUl li").width()).prepend($("#slideUl li:last-child")).animate({"margin-left":0},function(){})},a.fnGlayInfoRight=function(){$("#slideUl:not(:animated)").animate({"margin-left":-1*$("#slideUl li").width()},function(){$("#slideUl").css("margin-left","0"),$("#slideUl").append($("#slideUl li:first-child"))})},a.fnGlayStudyAdd=function(){var n=$(this).text();"ランダム"===n&&(n=Math.floor(5*Math.random())+1),$.ajax({type:"GET",url:"study/"+n+".json",dataType:"json"}).done(function(n){a.fnAllReset();var t=a.mainCanvasWidth+35,e=a.mainCanvasHeight+35;a.pcNode=n.pc.node,a.ruNode=n.router.node;for(var s=0;s<=n.lanNode;s++)$("#nsf-main-canvas").addClass("L_"+a.lanNode),a.lanArrWidth[s]=2,a.lanNode=s;for(var s=0;s<n.pc.node;s++)$("#nsf-main").append('<img src="img/pc.png" class="context-menu-PC lanLink '+n.pc.lan[s]+'" alt="PC'+s+'" style="position: absolute; top: '+(e+n.pc.style[s].top)+"px; left: "+(t+n.pc.style[s].left)+'px">'),$("#nsf-right dl").append("<dt><img src= img/plus.jpg>PC"+s+"</dt><dd><p>IP: <span>"+n.pc.ip[s]+"</span> /<span>"+n.pc.sm[s]+"</span></p></dd>"),$("#nsf-main img:last-child").data().ip=n.pc.ip[s],$("#nsf-main img:last-child").data().sm=n.pc.sm[s];for(var s=0;s<n.router.node;s++)$("#nsf-main").append('<img src="img/router.png" class="context-menu-Router lanLink '+n.router.lan[s]+'" alt="Router'+s+'" style="position: absolute; top: '+(e+n.router.style[s].top)+"px; left: "+(t+n.router.style[s].left)+'px">'),$("#nsf-right dl").append("<dt><img src= img/plus.jpg>Router"+s+"</dt><dd><p>IP-1: <span>"+n.router.ip[s].first+"</span> /<span>"+n.router.sm[s].first+"</span></p><p>IP-2: <span>"+n.router.ip[s].second+"</span> /<span>"+n.router.sm[s].second+"</span></p></dd>"),$("#nsf-main img:last-child").data().ip_1=n.router.ip[s].first,$("#nsf-main img:last-child").data().ip_2=n.router.ip[s].second,$("#nsf-main img:last-child").data().sm_1=n.router.sm[s].first,$("#nsf-main img:last-child").data().sm_2=n.router.sm[s].second;$("#nsf-right dd").css("display","none"),a.lanArrClass=$("#nsf-main-canvas").attr("class").split(/\s?L_/);for(var s=1;s<a.lanArrClass.length;s++)a.fnLanDraw(a.lanArrClass[s])}).fail(function(a,n){console.log(a),console.log(n)}).always(function(){a.fnAllGlayClose()})},a.fnAllGlayClose=function(){a.bGlayFladg=!1,$("#infoLeft").off("click",a.fnGlayInfoLeft),$("#infoRight").off("click",a.fnGlayInfoRight),$("#glayClose").off("click",a.fnAllGlayClose),$(".glayStudyMenu li").off("click",a.fnGlayStudyAdd),$("#glayLayer").css("display","none"),$("#glayLayer").empty()},a.fnMainDrop=function(n,t){if("img/pc.png"===n.draggable.attr("src")?(a.dropNodeInt=a.pcNode,a.dropNodeName="PC"+a.pcNode,a.dropContextName="context-menu-PC",a.pcNode++):"img/router.png"===n.draggable.attr("src")&&(a.dropNodeInt=a.ruNode,a.dropNodeName="Router"+a.ruNode,a.dropContextName="context-menu-Router",a.ruNode++),$("#nsf-main").append($("<img>").attr({src:n.draggable.attr("src"),alt:a.dropNodeName,"class":a.dropContextName,style:"position: absolute; top: "+n.offset.top+"px; left: "+n.offset.left+"px"})),$("#nsf-main img:last-child").draggable({containment:"parent",zIndex:2,drag:function(){($(this).prev().hasClass("get-node2")||$(this).prev().hasClass("send-node2"))&&($(this).prev().offset({top:this.offsetTop-15,left:this.offsetLeft+42}),$(this).prev().css("zIndex",3))},stop:function(){($(this).prev().hasClass("get-node2")||$(this).prev().hasClass("send-node2"))&&$(this).prev().css("zIndex",1)}}),"img/lanCable_2.png"===$("#lan").attr("src")){var e=$("#nsf-main img:last-child");e.css("cursor","crosshair"),e.mouseup(function(a){a.preventDefault()}),e.mousedown(function(a){a.preventDefault()}),e.mouseenter(function(){a.lanFlag=!0,$(this).addClass("lanOn"),$(this).draggable("disable")}).mouseleave(function(){a.lanFlag=!1,$(this).removeClass("lanOn"),$(this).draggable("enable")})}"img/pc.png"===n.draggable.attr("src")?($(t[0].lastChild).data().sm=24,$("#nsf-right dl").append("<dt><img src= img/plus.jpg>"+n.draggable.attr("alt")+ +a.dropNodeInt+"</dt><dd><p>IP: <span></span> /<span>24</span></p></dd>")):"img/router.png"===n.draggable.attr("src")&&($(t[0].lastChild).data().sm_1=24,$(t[0].lastChild).data().sm_2=24,$("#nsf-right dl").append("<dt><img src= img/plus.jpg>"+n.draggable.attr("alt")+ +a.dropNodeInt+"</dt><dd><p>IP-1: <span></span> /<span>24</span></p><p>IP-2: <span></span> /<span>24</span></p></dd>")),$("#nsf-right dd:last").css("display","none")},a.fnLanDown=function(n){a.lanFlag&&("img/pc.png"===$(n.target).attr("src")&&$(n.target).hasClass("lanLink")?$("#nsf-console").append("<p>> PCにLANは1本しか引けません。</p>"):(a.addCanvas=$('<canvas width="'+a.canvasWidth+'" height="'+a.canvasHeight+'"></canvas>').prependTo("#nsf-main"),a.lanFlagPoint=!0,$(this).children(".lanOn").hasClass("lanLink")&&(a.lanFlaglink=!0),$(this).children(".lanOn").addClass("lanFrist lanLink sP_"+a.lanNode),$("#nsf-main-canvas").addClass("L_"+a.lanNode),a.points=[{x:n.pageX-this.offsetLeft,y:n.pageY-this.offsetTop}],$("#nsf-main").on("mousemove",a.fnLanDrag)))},a.fnLanDrag=function(n){a.addCtx=a.addCanvas.get(0).getContext("2d"),a.points.push({x:n.pageX-this.offsetLeft,y:n.pageY-this.offsetTop}),a.addCtx.clearRect(0,0,a.canvasWidth,a.canvasHeight),a.addCtx.beginPath(),!$(n.target).hasClass("lanFrist")&&$(n.target).hasClass("lanOn")?a.addCtx.strokeStyle="#2fb9fe":a.addCtx.strokeStyle="#fb9003",a.addCtx.lineWidth=a.lanWidth,a.addCtx.moveTo(a.points[0].x,a.points[0].y),a.addCtx.lineTo(a.points[a.points.length-1].x,a.points[a.points.length-1].y),a.addCtx.stroke()},a.fnLanUp=function(n){if(a.lanFlagPoint){if(a.lanFlagDelet=!0,1===a.points.length||a.lanFlag===!1||$(n.target).hasClass("lanFrist"))a.lanFlaglink===!0?$(".sP_"+a.lanNode).removeClass("sP_"+a.lanNode):$(".sP_"+a.lanNode).removeClass("lanLink sP_"+a.lanNode),$("#nsf-main-canvas").removeClass("L_"+a.lanNode),a.lanFlagDelet=!1,a.lanNode--;else if($(n.target).hasClass("lanLink")&&"img/pc.png"===$(n.target).attr("src"))a.lanFlaglink===!0?$(".sP_"+a.lanNode).removeClass("sP_"+a.lanNode):$(".sP_"+a.lanNode).removeClass("lanLink sP_"+a.lanNode),$("#nsf-main-canvas").removeClass("L_"+a.lanNode),$("#nsf-console").append("<p>> PCにLANは1本しか引けません。</p>"),a.lanFlagDelet=!1,a.lanNode--;else for(var t=0;t<a.lanNode;t++)if($(".lanFrist").hasClass("sP_"+t)&&$(".lanOn").hasClass("eP_"+t)||$(".lanFrist").hasClass("eP_"+t)&&$(".lanOn").hasClass("sP_"+t)){$(".sP_"+a.lanNode).removeClass("sP_"+a.lanNode),$("#nsf-main-canvas").removeClass("L_"+a.lanNode),$("#nsf-console").append("<p>> 同じ所にLANは引けません。</p>"),a.lanFlagDelet=!1,a.lanNode--;break}!$(n.target).hasClass("lanFrist")&&$(n.target).hasClass("lanOn")&&a.lanFlagDelet&&(a.lanArrWidth[a.lanNode]=a.lanWidth,$(".lanOn").addClass("lanLink eP_"+a.lanNode),a.fnLanDraw(a.lanNode)),a.lanNode++,a.points=[],a.lanFlaglink=!1,a.lanFlagPoint=!1,a.addCanvas.remove(),$("#nsf-main").off("mousemove",a.lanDrag),$("#nsf-main .ui-draggable").removeClass("lanFrist")}},a.fnLanOutUp=function(){a.lanFlagPoint&&(a.addCanvas.remove(),a.lanFlaglink||$(".sP_"+a.lanNode).removeClass("lanLink"),$("#nsf-main").off("mousemove",a.fnLanDrag),$("#nsf-main .ui-draggable").removeClass("lanFrist"),$(".sP_"+a.lanNode).removeClass("sP_"+a.lanNode),$("#nsf-main-canvas").removeClass("L_"+a.lanNode),a.points=[],a.lanFlaglink=!1,a.lanFlagPoint=!1)},a.fnLanMoveDown=function(n){$(n.target).hasClass("lanLink")&&(a.elLanMoveThis=$(this),a.lanFlagMove=!0,a.lanArrClass=$("#nsf-main-canvas").attr("class").split(/\s?L_/),a.elLanMoveThis.on("mousemove",a.fnLanMoveDrag))},a.fnLanMoveDrag=function(){a.mainCtx.clearRect(0,0,a.canvasWidth,a.canvasHeight);for(var n=1;n<a.lanArrClass.length;n++)a.fnLanDraw(a.lanArrClass[n])},a.fnLanMoveUp=function(){a.lanFlagMove===!0&&(a.lanFlagMove=!1,a.elLanMoveThis.off("mousemove",a.fnLanMoveDrag))},a.fnLanMoveOutUp=function(){if(a.lanFlagMove===!0){a.mainCtx.clearRect(0,0,a.canvasWidth,a.canvasHeight);for(var n=1;n<a.lanArrClass.length;n++)a.fnLanDraw(a.lanArrClass[n]);a.lanFlagMove=!1,a.elLanMoveThis.off("mousemove",a.fnLanMoveDrag)}},a.fnLanDraw=function(n){"radio-1"===$("input[name=lanRadio]:checked").val()?(a.mainCtx.beginPath(),a.mainCtx.lineWidth=a.lanArrWidth[n],a.mainCtx.moveTo($(".sP_"+n)[0].offsetLeft-a.mainCanvasWidth,$(".sP_"+n)[0].offsetTop-a.mainCanvasHeight),a.mainCtx.lineTo($(".eP_"+n)[0].offsetLeft-a.mainCanvasWidth,$(".eP_"+n)[0].offsetTop-a.mainCanvasHeight),a.mainCtx.stroke()):"radio-2"===$("input[name=lanRadio]:checked").val()&&(a.mainCtx.beginPath(),a.mainCtx.lineWidth=a.lanArrWidth[n],a.mainCtx.moveTo($(".sP_"+n)[0].offsetLeft-a.mainCanvasWidth,$(".sP_"+n)[0].offsetTop-a.mainCanvasHeight),a.mainCtx.lineTo($(".sP_"+n)[0].offsetLeft-a.mainCanvasWidth,$(".sP_"+n)[0].offsetTop-a.mainCanvasHeight+($(".eP_"+n)[0].offsetTop-a.mainCanvasHeight-$(".sP_"+n)[0].offsetTop-a.mainCanvasHeight)/2),a.mainCtx.lineTo($(".eP_"+n)[0].offsetLeft-a.mainCanvasWidth,$(".sP_"+n)[0].offsetTop-a.mainCanvasHeight+($(".eP_"+n)[0].offsetTop-a.mainCanvasHeight-$(".sP_"+n)[0].offsetTop-a.mainCanvasHeight)/2),a.mainCtx.lineTo($(".eP_"+n)[0].offsetLeft-a.mainCanvasWidth,$(".eP_"+n)[0].offsetTop-a.mainCanvasHeight),a.mainCtx.stroke())},a.fnConfunc=function(n,t){if("del"===n){a.lanArrClass=$("#nsf-main-canvas").attr("class").split(/\s?L_/),a.mainCtx.clearRect(0,0,a.canvasWidth,a.canvasHeight);for(var e=1;e<a.lanArrClass.length;e++)this.hasClass("sP_"+a.lanArrClass[e])?($("#nsf-main img").removeClass("eP_"+a.lanArrClass[e]),$("#nsf-main-canvas").removeClass("L_"+a.lanArrClass[e])):this.hasClass("eP_"+a.lanArrClass[e])?($("#nsf-main img").removeClass("sP_"+a.lanArrClass[e]),$("#nsf-main-canvas").removeClass("L_"+a.lanArrClass[e])):a.fnLanDraw(a.lanArrClass[e]);$(this).remove(),$("#nsf-main img:not([class*='P_'])").removeClass("lanLink"),$("#nsf-right dt:contains('"+t.$trigger[0].alt+"'), #nsf-right dt:contains('"+t.$trigger[0].alt+"') + dd").remove(),$("#nsf-main .ui-draggable").hasClass("lanLink")||($("#nsf-main").off("mousedown",a.fnLanMoveDown),$("#nsf-main").off("mouseup",a.fnLanMoveUp),$("html").off("mouseup",a.fnLanMoveOutUp))}},$(window).resize(function(){var n=$("#nsf-main-canvas")[0].getBoundingClientRect().left-35,t=$("#nsf-main-canvas")[0].getBoundingClientRect().top-35,e=n-a.mainCanvasWidth,s=t-a.mainCanvasHeight;a.mainCanvasWidth=n,a.mainCanvasHeight=t,$("#nsf-main img").each(function(a,n){$(n).offset({left:$(n).offset().left+=e,top:$(n).offset().top+=s})}),a.bGlayFladg&&$("#glayLayer").css({top:$("#nsf-container").offset().top,left:$("#nsf-container").offset().left})}),$("#dust").click(function(){a.fnAllReset()}),$("#connect-start").click(function(){if("undefined"==typeof a)var a={};a.postData="",a.arrGetNode=0,a.arrSendNode=0,a.sortTotal=0,a.primaryTotal=0,a.totalNodeNum=0,a.arrGetMatch=[],a.arrSendMatch=[],a.pcMask=[],a.routerMask=[],a.arrSegPc=[],a.arrSegPcSplit=[],a.arrSegRouter=[],a.arrSegRouterSplit=[],a.arrSegAll=[],a.arrTypeAll=[],a.arrPrimaryAll=[],a.arrBsmAll=[],a.arrDsmAll=[],a.arrSegAllSort=[],a.arrTypeAllSort=[],a.arrPrimaryAllSort=[],a.arrBsmAllSort=[],a.arrDsmAllSort=[],$("#nsf-main .lanLink").each(function(){$(this).hasClass("get-node")?(a.arrGetMatch[a.arrGetNode]=$("#nsf-right dt:contains('"+$(this).attr("alt")+"') + dd p span:nth-of-type(1)").html(),a.arrGetNode++):$(this).hasClass("send-node")&&(a.arrSendMatch[a.arrSendNode]=$("#nsf-right dt:contains('"+$(this).attr("alt")+"') + dd p span:nth-of-type(1)").html(),a.arrSendNode++),a.totalNodeNum++}),$("#nsf-right dt:contains('Router') + dd p:nth-of-type(1) span:nth-of-type(2), #nsf-right dt:contains('Router') + dd p:nth-of-type(2) span:nth-of-type(2)").each(function(n,t){for(var e=$(t).text(),s=0;4>s;s++){void 0===a.routerMask[n]&&(a.routerMask[n]=[]),a.routerMask[n][s]="";for(var o=0;8>o;o++)e>0?(a.routerMask[n][s]+="1",e--):a.routerMask[n][s]+="0";a.routerMask[n][s]=parseInt(a.routerMask[n][s],2)}}),$("#nsf-right dt:contains('Router') + dd p:nth-of-type(1) span:nth-of-type(1), #nsf-right dt:contains('Router') + dd p:nth-of-type(2) span:nth-of-type(1)").each(function(n,t){var e="";a.arrSegRouter[n]=$(t).text(),a.arrSegRouterSplit[n]=a.arrSegRouter[n].split(/\./);for(var s=0;s<a.arrSegRouterSplit[n].length;s++)e+=a.arrSegRouterSplit[n][s]&String(a.routerMask[n][s]);for(var s=0;n>=s;s++){for(var o="",l=0;l<a.arrSegRouterSplit[s].length;l++)o+=a.arrSegRouterSplit[s][l]&String(a.routerMask[s][l]);if(e===o){if(void 0===a.arrSegAll[s]){a.arrSegAll[s]=[],a.arrTypeAll[s]=[],a.arrPrimaryAll[s]=[],a.arrBsmAll[s]=o,a.arrDsmAll[s]="";for(var l=0;4>l;l++)a.arrDsmAll[s]+=String(a.routerMask[s][l]),3!==l&&(a.arrDsmAll[s]+=".")}var r=a.arrSegAll[s].length;a.arrSegAll[s][r]=a.arrSegRouter[n],a.arrTypeAll[s][r]=1,a.arrPrimaryAll[s][r]=a.primaryTotal;break}}n%2!==0&&a.primaryTotal++});for(var n=0;n<=a.arrSegAll.length;n++)void 0!==a.arrSegAll[n]&&(a.arrSegAllSort[a.sortTotal]=a.arrSegAll[n],a.arrTypeAllSort[a.sortTotal]=a.arrTypeAll[n],a.arrPrimaryAllSort[a.sortTotal]=a.arrPrimaryAll[n],a.arrBsmAllSort[a.sortTotal]=a.arrBsmAll[n],a.arrDsmAllSort[a.sortTotal]=a.arrDsmAll[n],a.sortTotal++);if($("#nsf-right dt:contains('PC') + dd p span:nth-of-type(2)").each(function(n,t){for(var e=$(t).text(),s=0;4>s;s++){void 0===a.pcMask[n]&&(a.pcMask[n]=[]),a.pcMask[n][s]="";for(var o=0;8>o;o++)e>0?(a.pcMask[n][s]+="1",e--):a.pcMask[n][s]+="0";a.pcMask[n][s]=parseInt(a.pcMask[n][s],2)}}),$("#nsf-right dt:contains('PC') + dd p span:nth-of-type(1)").each(function(n,t){var e=!0,s="";a.arrSegPc[n]=$(t).text(),a.arrSegPcSplit[n]=a.arrSegPc[n].split(/\./);for(var o=0;o<a.arrSegPcSplit[n].length;o++)s+=a.arrSegPcSplit[n][o]&String(a.pcMask[n][o]);for(var o=0;o<a.arrSegAllSort.length;o++){var l=a.arrBsmAllSort[o];if(s===l){var r=a.arrSegAllSort[o].length;a.arrSegAllSort[o][r]=a.arrSegPc[n];for(var i=0;i<a.arrGetNode;i++)a.arrSegPc[n]===a.arrGetMatch[i]&&(a.arrTypeAllSort[o][r]=3,e=!1);for(var i=0;i<a.arrSendNode;i++)a.arrSegPc[n]===a.arrSendMatch[i]&&(a.arrTypeAllSort[o][r]=2,e=!1);e&&(a.arrTypeAllSort[o][r]=0),a.arrPrimaryAllSort[o][r]=a.primaryTotal,a.primaryTotal++;break}}}),$("#nsf-main img").hasClass("lanLink")){a.postData+="{",a.postData+='"total_node_num":'+a.totalNodeNum+",",a.postData+='"total_seg_num":'+a.arrSegAllSort.length+",";for(var n=0;n<a.arrSegAllSort.length;n++){a.postData+='"seg'+(n+1)+'":[',a.postData+='{"node_num":'+a.arrSegAllSort[n].length+',"seg":"'+a.arrDsmAllSort[n]+'"},';for(var t=0;t<a.arrSegAllSort[n].length;t++)a.postData+="{",a.postData+='"primary":'+a.arrPrimaryAllSort[n][t]+",",a.postData+='"type":'+a.arrTypeAllSort[n][t]+",",a.postData+='"IP":"'+a.arrSegAllSort[n][t]+'"',a.postData+="}",t!==a.arrSegAllSort[n].length-1&&(a.postData+=",");a.postData+="]",n!==a.arrSegAllSort.length-1&&(a.postData+=",")}a.postData+="}"}$("#nsf-console").append("<p>> 送信するデータ･･･</p><p>> "+a.postData+"</p>"),$.ajax({type:"POST",dataType:"json",url:"../../ns-allinone-3.25/ns-3.25/index.php",data:"data="+a.postData}).done(function(a){$("#nsf-console").append("<p>> 受信データ･･･"+a+"</p>")}).fail(function(){$("#nsf-console").append("<p>> エラーが発生したので処理を終了します。</p>")})}),$("#get-packet").click(function(){a.fnPacketChenge("get","send","reset")}),$("#send-packet").click(function(){a.fnPacketChenge("send","get","reset")}),$("#reset-packet").click(function(){a.fnPacketChenge("reset","get","send")}),$("#study").click(function(){a.bGlayFladg=!0,$("#glayLayer").css({display:"block",top:$("#nsf-container").offset().top,left:$("#nsf-container").offset().left,height:$("#nsf-container").height(),width:$("#nsf-container").width()}),$("#glayLayer").append('<img src="img/batu.png" id="glayClose" style="position: absolute; top: 10px; left: 970px">'),$("#glayLayer").append('<ul class="glayStudyMenu"><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>ランダム</li></ul>'),$("#glayClose").on("click",a.fnAllGlayClose),$(".glayStudyMenu li").on("click",a.fnGlayStudyAdd)}),$("#info").click(function(){a.bGlayFladg=!0,$("#glayLayer").css({display:"block",top:$("#nsf-container").offset().top,left:$("#nsf-container").offset().left,height:$("#nsf-container").height(),width:$("#nsf-container").width()}),$("#glayLayer").append('<div id="slideGalley" style="position: absolute; top: 76px; left: 117px"><ul id="slideUl"><li><img src="img/sample1.png"></li><li><img src="img/sample2.png"></li><li><img src="img/sample3.png"></li><li><img src="img/sample4.png"></li></ul></div>'),$("#glayLayer").append('<img src="img/batu.png" id="glayClose" style="position: absolute; top: 10px; left: 970px">'),$("#glayLayer").append('<img src="img/left.png" id="infoLeft" style="position: absolute; top: 306px; left: 25px">'),$("#glayLayer").append('<img src="img/right.png" id="infoRight" style="position: absolute; top: 306px; left: 950px">'),$("#infoLeft").on("click",a.fnGlayInfoLeft),$("#infoRight").on("click",a.fnGlayInfoRight),$("#glayClose").on("click",a.fnAllGlayClose)}),$("#cui").click(function(){$("#nsf-console").append("<p>> デバックしました。</p>")}),$(".machinery").draggable({helper:"clone",revert:!0,zIndex:2,start:function(){$(this).addClass("dragout")},stop:function(){$(this).removeClass("dragout")}}),$("#lan").click(function(){var n=$("html"),t=$("#nsf-main"),e=$("#nsf-main .ui-draggable");"img/lanCable.png"===$(this).attr("src")?($(this).attr("src","img/lanCable_2.png"),t.on("mousedown",a.fnLanDown),t.on("mouseup",a.fnLanUp),n.on("mouseup",a.fnLanOutUp),e.hasClass("lanLink")&&(t.off("mousedown",a.fnLanMoveDown),t.off("mouseup",a.fnLanMoveUp),n.off("mouseup",a.fnLanMoveOutUp)),t.css("cursor","crosshair"),e.css("cursor","crosshair"),e.mouseup(function(a){a.preventDefault()}),e.mousedown(function(a){a.preventDefault()}),e.mouseenter(function(){a.lanFlag=!0,$(this).addClass("lanOn"),$(this).draggable("disable")}).mouseleave(function(){a.lanFlag=!1,$(this).removeClass("lanOn"),$(this).draggable("enable")})):"img/lanCable_2.png"===$(this).attr("src")&&($(this).attr("src","img/lanCable.png"),t.off("mousedown",a.fnLanDown),t.off("mouseup",a.fnLanUp),n.off("mouseup",a.fnLanOutUp),e.off("mouseenter").off("mouseleave"),t.css("cursor","auto"),e.css("cursor","pointer"),e.hasClass("lanLink")&&(t.on("mousedown",a.fnLanMoveDown),t.on("mouseup",a.fnLanMoveUp),n.on("mouseup",a.fnLanMoveOutUp)))}),$("input[name=lanRadio]").click(function(){a.lanArrClass=$("#nsf-main-canvas").attr("class").split(/\s?L_/),a.mainCtx.clearRect(0,0,a.canvasWidth,a.canvasHeight);for(var n=1;n<a.lanArrClass.length;n++)a.fnLanDraw(a.lanArrClass[n])}),$("input[name=lanRadio-2]").click(function(){"radio-3"===$("input[name=lanRadio-2]:checked").val()?a.lanWidth=2:"radio-4"===$("input[name=lanRadio-2]:checked").val()?a.lanWidth=5:"radio-5"===$("input[name=lanRadio-2]:checked").val()&&(a.lanWidth=9)}),$("#nsf-main").droppable({accept:".machinery",tolerance:"fit",drop:function(n,t){a.fnMainDrop(t,$(this)),a.mainDropFlg=!1},deactivate:function(n,t){t.draggable.draggable({revert:a.mainDropFlg}),a.mainDropFlg===!1&&(a.mainDropFlg=!0)}}),$("#nsf-main").on("mouseover","img",function(){$("#nsf-right dt:contains('"+$(this).attr("alt")+"'), #nsf-right dt:contains('"+$(this).attr("alt")+"') + dd").css({color:"#49cbf6"})}).on("mouseout","img",function(){$("#nsf-right dt:contains('"+$(this).attr("alt")+"'), #nsf-right dt:contains('"+$(this).attr("alt")+"') + dd").css({color:""})}),$("#nsf-main").contextmenu(function(n){"img/lanCable_2.png"===$("#lan").attr("src")&&(a.lanFlag&&(a.lanFlag=!1,$(n.target).removeClass("lanOn"),$(n.target).draggable("enable")),$("#lan").attr("src","img/lanCable.png"),$("#nsf-main").off("mousedown",a.fnLanDown),$("#nsf-main").off("mouseup",a.fnLanUp),$("html").off("mouseup",a.fnLanOutUp),$("#nsf-main .ui-draggable").off("mouseenter").off("mouseleave"),$("#nsf-main").css("cursor","auto"),$("#nsf-main .ui-draggable").css("cursor","pointer"),$("#nsf-main .ui-draggable").hasClass("lanLink")&&($("#nsf-main").on("mousedown",a.fnLanMoveDown),$("#nsf-main").on("mouseup",a.fnLanMoveUp),$("html").on("mouseup",a.fnLanMoveOutUp)))}),$("#nsf-main").on("click",".context-menu-PC",a.fnPacketAdd),$("#nsf-right").on("click","img",function(){var a=$(this);"img/plus.jpg"===a.attr("src")?(a.attr("src","img/minus.jpg"),a.parent("dt").next().show()):"img/minus.jpg"===a.attr("src")&&(a.attr("src","img/plus.jpg"),a.parent("dt").next().hide())}),$("#nsf-right-info img").on("click",function(){"img/open.png"===$(this).attr("src")&&($("#nsf-right dd").show(),$("#nsf-right dt img").attr("src","img/minus.jpg")),"img/close.png"===$(this).attr("src")&&($("#nsf-right dd").hide(),$("#nsf-right dt img").attr("src","img/plus.jpg"))}),$.contextMenu({selector:".context-menu-PC",items:a.conitems,events:a.conev,callback:a.fnConfunc}),$.contextMenu({selector:".context-menu-Router",items:a.conitems_2,events:a.conev_2,callback:a.fnConfunc}),$(".hint").mouseover(function(a){$("#"+a.target.id).next().show()}).mouseout(function(a){$("#"+a.target.id).next().hide()}).mousemove(function(a){$("span.tooltip").css({top:a.pageY+35+"px",left:a.pageX})})});
